# overwrite: true
# schema: "packages/client/src/graphql/{server,local}.graphql"
# documents: "packages/client/src/{stories,components}/**/!(*.generated).graphql"
# generates:
#   src/generated/graphql.tsx:
#     plugins:
#       - "typescript"
#       - "typescript-operations"
#       - "typescript-resolvers"
#       - "typescript-react-apollo"
#   ./graphql.schema.json:
#     plugins:
#       - "introspection"

overwrite: true

watch: true
# Passed directly through to chokidar's file watch configuration
watchConfig:
  usePolling: true
  interval: 1000
generates:
  # generate the types for the graphql resolvers
  packages/client/src/graphql/resolvers.generated.ts:
    schema: "packages/client/src/graphql/server.graphql"
    config:
      useIndexSignature: true
      # defaultMapper: Partial<{T}>
    plugins:
      - "typescript"
      - "typescript-resolvers"
  packages/client/src/graphql/schema.server.generated.json:
    schema: "packages/client/src/graphql/server.graphql"
    plugins:
      - introspection
  
  # generate the types for the server+local graphql API
  packages/client/src/graphql.generated.tsx:
    schema: "packages/client/src/graphql/{server,local}.graphql"
    plugins:
      - "typescript"
      - "typescript-apollo-client-helpers"
    config:
      nonOptionalTypename: true
      avoidOptionals: true

  # generate the types for the React component queries
  packages/client/src/:
    schema: "packages/client/src/graphql/{server,local}.graphql"
    documents: 
     - "packages/client/src/{stories,components}/**/!(*.generated).graphql"
    preset: near-operation-file
    presetConfig:
      extension: .generated.tsx
      baseTypesPath: graphql.generated.tsx
    plugins:
      - typescript-operations
      - typescript-react-apollo

  ./graphql.schema.json:
    schema: "packages/client/src/graphql/{server,local}.graphql"
    plugins:
      - "introspection"

