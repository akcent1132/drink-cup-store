# .gitlab-ci.yml

# Sets the docker image for the job
image: node:latest

# Sets the stages for the pipeline
stages:
  - test

# Cache the dependencies
cache:
  key: $CI_COMMIT_REF_SLUG-$CI_PROJECT_DIR
  paths:
    - ./packages/client/.yarn

# Installs the dependencies
before_script:
  - cd ./packages/client
  - ls -la .yarn
  - yarn chromatic install --frozen-lockfile --prefer-offline --cache-folder .yarn

#ðŸ‘‡Adds Chromatic as a job
chromatic_publish:
  stage: test
  script:
    - cd ./packages/client
    - ls -la .yarn
    - yarn
    - yarn chromatic --debug --project-token=$CHROMATIC_PROJECT_TOKEN --exit-zero-on-changes